<%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%>
<%@page import="java.util.HashMap"%>
<%@page import="java.util.Map"%>
<%@page import="static com.asha.icgweb.utils.RequestConstants.*"%>
<%@page import="com.asha.icgweb.utils.HMSUtil"%>
<%-- <%@page import="static com.asha.icgweb.utils.HMSUtil.*"%> --%>

<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form" %>
 <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> <html>
                    <head>
                     <script type="text/javascript" src="${pageContext.request.contextPath}/resources/js/jquery.min.js"></script>
                    <script type="text/javascript" src="${pageContext.request.contextPath}/resources/js/jquery.common.js"></script>
                    <script type="text/javascript" src="${pageContext.request.contextPath}/resources/js/common.js"></script>
                    <script type="text/javascript" src="${pageContext.request.contextPath}/resources/js/ajax.js"></script>
                    <script type="text/javascript" src="${pageContext.request.contextPath}/resources/js/pops_global.js"></script>
                    <script type="text/javascript" src="${pageContext.request.contextPath}/resources/js/pops_menu.js"></script>
                    <script type="text/javascript" src="${pageContext.request.contextPath}/resources/js/hms.js"></script>
                    
                    
                     <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
                     <title>Patient Details List</title>
               
                  <!-- Below link replace with local css/js file -->      
                     <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
 	    		     <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>       
 				<!-- Above link replace with local css/js file --> 
                    </head>
                    <body bgcolor="">
                        <div class="wrapper">
                            <div class="sidebar" data-background-color="white" data-active-color="danger"> 
                            </div>
                            <div class="main-panel">
                                <div class="content">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-lg-12 col-md-7">
                                                <div class="card">
                                                    <div class="header">
                                                        <h4 class="title">Create Appointment of ICG Employee and Dependent</h4>
                                                    </div>
                                                 
<!-- Start tab coding  -->  

							<ul class="nav nav-tabs">
							    <li><a data-toggle="tab" href="#empTab">Employee Personal Details</a></li>
							    <li><a data-toggle="tab" href="#patientTab">Patient Details</a></li>
							</ul>
							 <br>
							 <div class="tab-content" id="tabs">
							    <div id="empTab" class="tab-pane">
   												    <div class="clearfix"></div>
                                                    <div class="col-md-2">
                                                        <form id="visitEmployee" name="visitEmployee" action="">
                                                            <label>Service No.<span>*</span></label>
                                                            <input id="serviceNoId" class="auto" size="8" type="text" name="<%=SERVICE_NO %>" value="" title="Enter Employee No" validate="Employee No,string,yes" maxlength="20" onblur="findEmployeeAndDependent(this.value);" />
 															<p align="Left" id="message" style="color:green; font-weight: bold;" ></p>
                                                        </form>
                                                    </div>
                                                       
                                                    <!-- Data Grid -->
                                                   
                                                    <div id="tblEmpAndDetails"  style="display:none" class="right_col" role="main" style="padding: 0.5%  1.8%;">
                                                            <div class="clearfix"></div>
                                                            <h5 style="text-decoration:underline;">List of Details</h5>
                                                           <table class="table table-striped table-bordered  ">
                                                                            <thead>
                                                                                <tr>
                                                                                    <th id="th1">Name</th>
                                                                                    <th id="th2">Age</th>
                                                                                    <th id="th3">Gender</th>
                                                                                    <th id="th4">DOB</th>
                                                                                    <th id="th5">Relation</th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody id="tblListOfEmployeeAndDepenent">
                                                                            </tbody>
                                                                        </table>
                                                   			 </div>
							 						  </div>
							   
		<div id="patientTab"  class="tab-pane">
		<!-- Start  form patient   -->   
		<form id="patientDetailsForm"  name="patientDetailsForm" action="" method="POST">
        <div class="row">		
            <div class="col-md-4">
                    <div class="form-group row">
                        <label for="service" class="col-sm-5 col-form-label">Service No.</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="empService" name="empService">
                            <input type="hidden" class="form-control" id="uhidNo" name="uhidNo">
                        </div>
                    </div>
                 
                    <div class="form-group row">
                        <label for="First Name" class="col-sm-5 col-form-label">Name</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="empName" name="empName">
                        </div>
                    </div>
                    
                    
                    
                     <div class="form-group row">
                        <label for="region" class="col-sm-5 col-form-label">Region/Command</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="region" name="region">
                             <input type="hidden" class="form-control" id="regionId" name="regionId">
                        </div>
                    </div>
                    
                    
                    <div class="form-group row">
                        <label for="religion" class="col-sm-5 col-form-label">Religion</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="religion" name="religion">
                            <input type="hidden" class="form-control" id="religionId" name="religionId">
                        </div>
                    </div>
                 
                   
                            
            </div>
            <div class="col-md-4">
                
                    <div class="form-group row">
                        <label for="rank" class="col-sm-5 col-form-label">Rank</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="rank" name="rank">
                             <input type="hidden" class="form-control" id="rankId" name="rankId">
                        </div>
                    </div>
                    
                     <div class="form-group row">
                        <label for="service" class="col-sm-5 col-form-label">Total Service</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="totalservice" name="totalservice">
                            <input type="hidden" class="form-control" id="empServiceJoinDate" name="empServiceJoinDate">
                            
                        </div>
                    </div>
                 
                    <div class="form-group row">
                        <label for="recordoffice" class="col-sm-5 col-form-label">Record Office</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="recordoffice" name="recordoffice">
                            <input type="hidden" class="form-control" id="recordofficeId" name="recordofficeId">
                        </div>
                    </div>
                    
                     
                  
                               
            </div>
            <div class="col-md-4">
                
                     <div class="form-group row">
                        <label for="trade_branch" class="col-sm-5 col-form-label">Trade/Branch</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="trade" name="trade">
                             <input type="hidden" class="form-control" id="tradeId" name="tradeId">
                        </div>
                    </div>
                    
                    
                    
                     <div class="form-group row">
                        <label for="unit" class="col-sm-5 col-form-label">Unit</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="unit" name="unit">
                            <input type="hidden" class="form-control" id="unitId" name="unitId">
                        </div>
                    </div>
                    
                    
                      <div class="form-group row">
                        <label for="marital status" class="col-sm-5 col-form-label">Marital Status</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="maritalstarus" name="maritalstarus">
                            <input type="hidden" class="form-control" id="maritalstarusId" name="maritalstarusId">
                        </div>
                    </div>
            </div>
        </div>
		
		<br>
		
		<h6 style="text-decoration:underline">Patient Details</h6>
		 
        <div class="row">		
            <div class="col-md-4">
			
                    <div class="form-group row">
                        <label for="Name" class="col-sm-5 col-form-label">Name</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="patientname" name="patientname">
                        </div>
                    </div>
                    
                  <div class="form-group row">
                        <label for="DOB" class="col-sm-5 col-form-label">DOB</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="patientDOB" name="patientDOB">
                        </div>
                    </div>
                   
                 
                    <div class="form-group row">
                        <label for="recordoffice" class="col-sm-5 col-form-label">Address</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="patientAddress" name="patientAddress">
                        </div>
                    </div>
                 
					<div class="form-group row">
						<label for="recordoffice" class="col-sm-5 col-form-label">Pin Code</label>
						<div class="col-sm-7">
							<input type="text" class="form-control" id="patientPincode" name="patientPincode">
						</div>
					</div>
				   				
            </div>
            <div class="col-md-4">
             <div class="form-group row">
                        <label for="service" class="col-sm-5 col-form-label">Relation</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="patientRelation" name="patientRelation">
                            <input type="hidden" class="form-control" id="patientRelationId" name="patientRelationId">
                        </div>
                    </div>
			  
                     <div class="form-group row">
                        <label for="service" class="col-sm-5 col-form-label">Age</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="patientAge" name="patientAge">
                        </div>
                    </div>
                    
                     <div class="form-group row">
                        <label for="marital status" class="col-sm-5 col-form-label">City</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="patientCity" name="patientCity">
                        </div>
                    </div>
                    
                    
                     <div class="form-group row">
                        <label for="region" class="col-sm-5 col-form-label">Email Address</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="patientEmail" name="patientEmail">
                        </div>
                    </div>
                    
                   
                 
                   
                                
            </div>
            <div class="col-md-4">
            
             <div class="form-group row">
                        <label   class="col-sm-5 col-form-label">Gender</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="gender" name="gender">
                            <input type="hidden" class="form-control" id="genderId" name="genderId">
                        </div>
                    </div>
                
                    
                
                    <div class="form-group row">
                        <label for="unit" class="col-sm-5 col-form-label">Mobile Number</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="patientMoblienumber" name="patientMoblienumber">
                        </div>
                    </div>
            
                    <div class="form-group row">
                        <label for="state" class="col-sm-5 col-form-label">State</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="patientState" name="patientState">
                            <input type="hidden" class="form-control" id="patientStateId" name="patientStateId">
                        </div>
                    </div>
            </div>
        </div>
		 
		<br>
		<h5 style="text-decoration:underline">NOK Details</h5>		
		<h6 style="text-decoration:underline">NOK Details1</h6>
		
        <div class="row">		
            <div class="col-md-4">
			    
                    <div class="form-group row">
                        <label for="First Name" class="col-sm-5 col-form-label">Name</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="nok1Firstname" name="nok1Firstname">
                        </div>
                    </div>
                
                    <div class="form-group row">
                        <label for="recordoffice" class="col-sm-5 col-form-label">Address</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="nok1Address" name="nok1Address">
                        </div>
                    </div>
                
                    <div class="form-group row">
                        <label for="unit" class="col-sm-5 col-form-label">Mobile Number</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="nok1Moblienumber" name="nok1Moblienumber">
                        </div>
                    </div>
            </div>
            <div class="col-md-4">			
			 
                    <div class="form-group row">
                        <label for="service" class="col-sm-5 col-form-label">Relation</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="nok1Relation" name="nok1Relation">
                            <input type="hidden" class="form-control" id="nok1RelationId" name="nok1RelationId">
                        </div>
                    </div>
                 
                    <div class="form-group row">
                        <label for="policestation" class="col-sm-5 col-form-label">Police Station</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="nok1Policestation" name="nok1Policestation">
                        </div>
                    </div>
                
                    <div class="form-group row">
                        <label for="region" class="col-sm-5 col-form-label">Email Address</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="nok1Email" name="nok1Email">
                        </div>
                    </div>
                			               
            </div>
			
            <div class="col-md-4">			
			     
					<div class="form-group row">
						<label for="recordoffice" class="col-sm-5 col-form-label">Pin Code</label>
						<div class="col-sm-7">
							<input type="text" class="form-control" id="nok1pincode" name="nok1pincode">
						</div>
					</div>
				 
                    <div class="form-group row">
                        <label for="contactnumber" class="col-sm-5 col-form-label">Contact Number</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="nok1Contactnumber" name="nok1Contactnumber">
                        </div>
                    </div>
                               
            </div>
        </div>
			
		
		
		<br>
		
		
		<h6 style="text-decoration:underline">NOK Details2</h6>
		
        <div class="row">		
            <div class="col-md-4">
			   
                    <div class="form-group row">
                        <label for="First Name" class="col-sm-5 col-form-label">Name</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="nok2Firstname"  name="nok2Firstname">
                        </div>
                    </div>
                
                    <div class="form-group row">
                        <label for="recordoffice" class="col-sm-5 col-form-label">Address</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="nok2Address" name="nok2Address">
                        </div>
                    </div>
                
                    <div class="form-group row">
                        <label for="unit" class="col-sm-5 col-form-label">Mobile Number</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="nok2Moblienumber"  name="nok2Moblienumber">
                        </div>
                    </div>
                				 				
            </div>
			
            <div class="col-md-4">			
			 
                    <div class="form-group row">
                        <label for="service" class="col-sm-5 col-form-label">Relation</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="nok2Relation"  name="nok2Relation">
                            <input type="hidden" class="form-control" id="nok2RelationId" name="nok2RelationId">
                        </div>
                    </div>
                 
                    <div class="form-group row">
                        <label for="policestation" class="col-sm-5 col-form-label">Police Station</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="nok2Policestation"  name="nok2Policestation">
                        </div>
                    </div>
                
                    <div class="form-group row">
                        <label for="region" class="col-sm-5 col-form-label">Email Address</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="nok2Email"  name="nok2Email">
                        </div>
                    </div>
                 			               
            </div>
			
            <div class="col-md-4">			
			   
					<div class="form-group row">
						<label for="recordoffice" class="col-sm-5 col-form-label">Pin Code</label>
						<div class="col-sm-7">
							<input type="text" class="form-control" id="nok2pincode"  name="nok2pincode">
						</div>
					</div>
				 
                    <div class="form-group row">
                        <label for="contactnumber" class="col-sm-5 col-form-label">Contact Number</label>
                        <div class="col-sm-7">
                            <input type="text" class="form-control" id="nok2Contactnumber" name="nok2Contactnumber">
                        </div>
                    </div>
                               
            </div>
        </div>
		
		 
		<div class="clearfix"> </div>
		<br> 
		<h6 style="text-decoration:underline">Medical Detail</h6>
        <div class="row">		
            <div class="col-md-3">
			   
                    <div class="form-group row">
                        <label for="Blood Group" class="col-sm-5 col-form-label">Blood Group</label>
                        <div class="col-sm-7">
                           <select id="bloodGroupId" name="bloodGroup" class="form-control">
								<option value="0" selected="selected">Select</option>
							</select> 
                        </div>
                    </div>
                 				
            </div> 
            <div class="col-md-3">			
			    
                    <div class="form-group row">
                        <label for="service" class="col-sm-5 col-form-label">Present Medical Category </label>
						<div class="col-md-7">  
							<select id="medicalCategoryId" name="medicalCategory" class="form-control">
								<option value="0" selected="selected">Select</option>
							</select> 
		                </div>
                    </div>
                	               
            </div> 
            <div class="col-md-3">			
			    
					<div class="form-group row">
						<label for="date" class="col-sm-2 col-form-label">Date</label>
						<div class="col-sm-10">
							<input type="text" class="form-control" id="dateId" name="date" >
						</div>
					</div>
				      
            </div> 
			 <div class="col-md-3">			
			    
					<div class="form-group row">
						<label for="duration" class="col-sm-5 col-form-label">Duration</label>
						<div class="col-md-7">  
							<select class="form-control" id="durationId" name="duration">
								<option value="0" selected="selected">Select</option>
								<option value="1">Year</option>
								<option value="2">Month</option> 
							</select> 
		                </div>
					</div>
				     
            </div>
        </div>
		
	 
	 <div class="clearfix"> </div>
	      <br> 
		<h6 style="text-decoration:underline">Visit Detail</h6>
			 <br> 
	<%int i=1; %>
	
      <div id="departmentNSessionList" >
        <div class="row" id="div<%=i %>" >	<!-- Visit details div start with department -->	
           
            <div class="col-md-3">			
                    <div class="form-group row">
                        <label for="service" class="col-sm-4 col-form-label">Department </label> 
						<div class="col-md-8">   
							<select id="departmentId<%=i%>" name="department" onchange="geAppointmentType(<%=i %>)" class="form-control">
                                <option value="0" selected="selected">Select</option>
							</select> 
		                </div>
                    </div>
            </div> 
            <div class="col-md-2">			
                    <div class="form-group row">
                        <label for="Priority" class="col-sm-4 col-form-label">Priority</label> 
						<div class="col-md-8">  
							<select name="priority" id="priorityId<%=i%>" class="form-control"  >
         					   <option value="1">1</option>
          					   <option value="2">2</option>
           					   <option value="3" selected="selected">3</option>
            				</select>
		                </div>
                    </div>
            </div>
             
             <div class="form-group row">
				<table border="0" cellspacing="0" cellpadding="0" width="50%" id="appTypeTable<%=i%>"></table>
			</div>
      <%--  Below code comment to remove static check box and appointment type drop down    
      <div class="col-md-2">			
					<div class="form-group row">
						<div class="form-check">
								<input type="checkbox" class="form-check-input" id="opdCheckBox<%=i %>" onclick="enableDropDown(<%=i %>)">
								<label class="form-check-label" for="opdCheckBox">OPD Consultation</label>
							  </div>
					    </div>
            </div> 
			 <div class="col-md-2">			
					<div class="form-group row">
						<div class="col-md-12" id="appTypeDivId<%=i %>" name="appTypeDiv">  
							<select id="appointmentTypeId<%=i %>" name="appointmentType" class="form-control">
								<option value="0" selected="selected">Select</option>
							</select> 
		                </div>
					</div>
            </div>
			<div class="col-md-2">			
					<div class="form-group  row">
						<div class="form-check">
								<input type="checkbox" class="form-check-input" id="mbCheckBox1">
								<label class="form-check-label" for="exampleCheck1">Medical Board</label>
							  </div>
					    </div>
            </div>
			<div class="col-md-1">			
					<div class="form-group  row">
						<div class="form-check">
								<input type="checkbox" class="form-check-input" id="meCheckBox1">
								<label class="form-check-label" for="exampleCheck1">Initiate ME</label>
							  </div>
					    </div>
				</div> 
				
				End of the comment part
				--%>
				
				
				</div>
				<div class="row" >
				
			     <!--    <div class="col-md-2">			
						 <div id="displayToken1" >
						 <input type="text" style="display:none" name ="tokenNoId1" id="tokenNoId1" value=""/>
						 </div>
					 </div> -->
					 <div id = "displayToken"></div>
					 
					  <!-- <div class="col-md-2">
					     <button class="btn btn-primary" type="button" onclick="addDiv();">Add</button>
						 <button class="btn btn-danger" type="button" onclick="removeDiv();" >Delete</button>
						 
					 </div> -->
					 
					 <div class="col-md-8">
					 </div>
		 
				
		   </div> <!-- Visit details div  with department -->
		</div> 
		
		 <br>
		  <div class="row">		
		   <div class="col-md-12">		
		     <button  class="btn btn-primary" type="button"  name="Print" onClick="validateDivToken()">Show Token</button>	
			 <button class="btn btn-primary" type="button" onclick="submitFormdata()">Submit</button>
			</div>
		  </div>
<input type="hidden" name ="divCount" id="divCount" value="1"/>		
  </form> 
			 <!-- End form patient   --> 
	</div>
	</div>
                                                    
                                                  
 <!-- End Tab Coding   -->                
                              
                                                </div>
                                            </div>
                                        </div>
                                      
                                    </div>
                                </div>
                            </div>

                        </div>

<script type="text/javascript" language="javascript">

$j(document).ready(function(){
	var deptValues = "";
	var bloodValues = "";
	var categoryValues = "";
	 	
		 var dictionary = ${data};
		 var deptList=dictionary.departmentList;
		 var bloodGroupList=dictionary.bloodGroupList;
		 var medicalCategoryList=dictionary.medicalCategoryList;
		 
		 for(dept in deptList){
				deptValues += '<option value='+deptList[dept].departmentId+'>'
							+ deptList[dept].departmentName
							+ '</option>';
		 }
		 $j('#departmentId1').append(deptValues); 	  
	  
		 
		 for(blood in bloodGroupList){
			 bloodValues += '<option value='+bloodGroupList[blood].bloodGroupId+'>'
							+ bloodGroupList[blood].bloodGroupName
							+ '</option>';
		 }
		 $j('#bloodGroupId').append(bloodValues); 	  
	  
		 
		 for(category in medicalCategoryList){
			 categoryValues += '<option value='+medicalCategoryList[category].medicalCategoryId+'>'
							+ medicalCategoryList[category].medicalCategoryName
							+ '</option>';
		 }
		 $j('#medicalCategoryId').append(categoryValues); 
		 
	  
		 activaTab('empTab');
	  
		 
	  
	});



 function findEmployeeAndDependent(serviceNo) {
         if (serviceNo) {
             var params = {
                "serviceNo": serviceNo
                   }
               var data = params;
               var url = 'getEmployeeAndDependentlist';
               var bClickable = true;
                 GetJsonData('tblListOfEmployeeAndDepenent', data, url, bClickable);
                 }else{
                 alert("Please enter the service number");
                  return false;
                  }
                 }

 function makeTable(jsonData) {
     var htmlTable = "";
     if(jsonData.status==1){
    var data = jsonData.count;
    var dataList = jsonData.data;
		 for(item in dataList){
			  // htmlTable += '<tr id="'+dataList[item].Id+'" onclick="hello('+dataList+')">';
	    	  htmlTable = htmlTable + "<tr id='" + dataList[item].Id + "'>";
	    	  htmlTable = htmlTable + "<td style='width: 150px;'>" + dataList[item].name + "</td>";
	    	  htmlTable = htmlTable + "<td style='width: 150px;'>" + dataList[item].age + "</td>";
	    	  htmlTable = htmlTable + "<td style='width: 150px;'>" + dataList[item].gender + "</td>";
	    	  htmlTable = htmlTable + "<td style='width: 150px;'>" + dataList[item].dateOfBirth + "</td>";
	    	  htmlTable = htmlTable + "<td style='width: 150px;'>" + dataList[item].relation + "</td>";
	    	  
	      }
	      $j("#tblListOfEmployeeAndDepenent").html(htmlTable);
		  $j('#tblEmpAndDetails').show();
	}else{
		 $j('#message').html(jsonData.msg);
		 $j('#tblEmpAndDetails').empty();
		 $j("#tblListOfEmployeeAndDepenent").empty();
		 /* $j(document).ready(function(){
             $j('#message').fadeOut(5000);
             }); */
        
	}
  }
 
 

function executeClickEvent(rowId,jsonData) {
	
	 <% int selfRelationId = Integer.parseInt(HMSUtil.getProperties("urlextension.properties", "SELF_RELATION_ID")); %>
	
	var dataList=jsonData.data;
	 for(item in dataList){
		 if(dataList[item].Id===parseInt(rowId)){
		 $j('#uhidNo').val(dataList[item].uhidNo); 
		 $j('#empService').val(dataList[item].serviceNo); 
		 $j('#rank').val(dataList[item].empRank); 
		 $j('#rankId').val(dataList[item].empRankId); 
		 $j('#trade').val(dataList[item].empTradeName); 
		 $j('#tradeId').val(dataList[item].empCommandId); 
		 $j('#empName').val(dataList[item].empName); 
		 $j('#totalservice').val(dataList[item].empTotalService); 
		 $j('#empServiceJoinDate').val(dataList[item].empServiceJoinDate); 
		 $j('#unit').val(dataList[item].empUnitName); 
		 $j('#unitId').val(dataList[item].empUnitId); 
		 $j('#region').val(dataList[item].empCommandName); 
		 $j('#regionId').val(dataList[item].empCommandId);
		 $j('#recordoffice').val(dataList[item].empRecordOfficeName); 
		 $j('#recordofficeId').val(dataList[item].empRecordOfficeId); 
		 $j('#maritalstarus').val(dataList[item].empMaritalStatusName); 
		 $j('#maritalstarusId').val(dataList[item].empMaritalStatusId); 
		 $j('#religion').val(dataList[item].empReligion); 
		 $j('#religionId').val(dataList[item].empReligionId); 
		 
		 $j('#patientname').val(dataList[item].name);
		 $j('#patientRelation').val(dataList[item].relation); 
		 $j('#patientRelationId').val(dataList[item].relationId); 
		 $j('#patientAge').val(dataList[item].age); 
		 $j('#patientAddress').val(dataList[item].patientAddress); 
		 $j('#patientPincode').val(dataList[item].patientPincode); 
		 $j('#patientGender').val(dataList[item].gender);
		 $j('#patientGenderId').val(dataList[item].genderId);
		 $j('#patientMoblienumber').val(dataList[item].mobileNumber); 
		 $j('#patientCity').val(dataList[item].city); 
		 $j('#patientDOB').val(dataList[item].dateOfBirth); 
		 $j('#patientEmail').val(dataList[item].patientEmailId); 
		 $j('#patientState').val(dataList[item].stateName);
		 $j('#patientStateId').val(dataList[item].stateNameId);
		 


		 $j('#nok1Firstname').val(dataList[item].nok1Name); 
		 $j('#nok1Address').val(dataList[item].Nok1Address); 
		 $j('#nok1Moblienumber').val(dataList[item].nok1MobileNo); 
		 $j('#nok1Relation').val(dataList[item].nok1Relation); 
		 $j('#nok1RelationId').val(dataList[item].nok1RelationId);
		 $j('#nok1Policestation').val(dataList[item].nok1Policestation); 
		 $j('#nok1Email').val(dataList[item].nok1EamilId); 
		 $j('#nok1pincode').val(dataList[item].nok1Pincode); 
		 $j('#nok1Contactnumber').val(dataList[item].nok1ContactNo); 
		 
		 
		 $j('#nok2Firstname').val(dataList[item].nok2Name); 
		 $j('#nok2Address').val(dataList[item].nok2Address); 
		 $j('#nok2Moblienumber').val(dataList[item].nok2MobileNo); 
		 $j('#nok2Relation').val(dataList[item].nok2Relation); 
		 $j('#nok2RelationId').val(dataList[item].nok2RelationId); 
		 $j('#nok2Policestation').val(dataList[item].nok2Policestation); 
		 $j('#nok2Email').val(dataList[item].nok2EamilId); 
		 $j('#nok2pincode').val(dataList[item].nok2Pincode); 
		 $j('#nok2Contactnumber').val(dataList[item].nok2ContactNo); 
		 
		 
		 $j('[name=bloodGroup] option').filter(function() { 
			    return ($j(this).text() ==dataList[item].patientBloodGroup); 
			}).prop('selected', true);
		
		 
		
		 if(dataList[item].relationId==<%=selfRelationId%>){
			 $j('[name=medicalCategory] option').filter(function() { 
				    return ($j(this).text() ==dataList[item].empMedicalCategory); 
				}).prop('selected', true); 
		 }else{
			 
			 $j("#medicalCategoryId").val($j("#medicalCategoryId option:first").val());
			
		 }
		
		 $j('#dateId').val(dataList[item].dateME); 
		 
		
		 makeFieldsReadonly();	 
		 activaTab('patientTab');
		 }
	}
 }
 
 
 function activaTab(tabId){
	 $j('.nav-tabs a[href="#' + tabId + '"]').tab('show');
 }
 
 function makeFieldsReadonly(){
	 	 $j("#empService").prop("readonly", true); 
		 $j('#empService').prop("readonly", true);
		 $j('#rank').prop("readonly", true);
		 $j('#trade').prop("readonly", true);
		 $j('#empName').prop("readonly", true);
		 $j('#totalservice').prop("readonly", true);
		 $j('#unit').prop("readonly", true);
		 $j('#region').prop("readonly", true);
		 $j('#recordoffice').prop("readonly", true);
		 $j('#maritalstarus').prop("readonly", true);
		 $j('#religion').prop("readonly", true);
		 
		 $j('#patientname').prop("readonly", true);
		 $j('#patientRelation').prop("readonly", true);
		 $j('#patientAge').prop("readonly", true);
		 $j('#patientAddress').prop("readonly", true);
		 $j('#patientPincode').prop("readonly", true);
		 $j('#patientGender').prop("readonly", true); 
		 $j('#patientMoblienumber').prop("readonly", true);
		 $j('#patientCity').prop("readonly", true);
		 $j('#patientDOB').prop("readonly", true);
		 $j('#patientEmail').prop("readonly", true);
		 $j('#patientState').prop("readonly", true);
		 


		 $j('#nok1Firstname').prop("readonly", true);
		 $j('#nok1Address').prop("readonly", true);
		 $j('#nok1Moblienumber').prop("readonly", true);
		 $j('#nok1Relation').prop("readonly", true);
		 $j('#nok1Policestation').prop("readonly", true);
		 $j('#nok1Email').prop("readonly", true);
		 $j('#nok1pincode').prop("readonly", true);
		 $j('#nok1Contactnumber').prop("readonly", true);
 }
 
 
 
 function geAppointmentType(count){
		var deptId = $j('#departmentId'+count).find('option:selected').val();
		var params = {
				"deptId":deptId
		}
		$j.ajax({
			type : "POST",
			contentType : "application/json",
			url : '${pageContext.request.contextPath}/appointment/getLocationWiseAppointmentType',
			data : JSON.stringify(params),
			dataType : "json",
			cache : false,
			success : function(data) {
				if (data.status == '1') {
					var checkboxorder = [];
					var labelId = [];
					var idandType = [];
					var checkboxLength = data.appointmentTypeList.length;
					for(var a = 0;a< checkboxLength;a++){
						checkboxorder[a] = data.appointmentTypeList[a].masAppointmentType.appointmentTypeName;
						labelId[a] = data.appointmentTypeList[a].masAppointmentType.appointmentTypeId;
						idandType[a] = checkboxorder[a]+'@'+ labelId[a];
						
					}
					var tablebody = '<tr>';
					var tokenDisplay = '';
					x=0;
					for(var z=0;z<checkboxLength;z++){
						tablebody += '<td>';
						var checkBoxIdandValue = idandType[z].split("@");
						tablebody += '<input type="checkbox"  id ="td'+checkBoxIdandValue[0]+'" name="checkDiv'+count+ '" value="'+checkBoxIdandValue[1]+'"><span id="td'+z+'">'+checkBoxIdandValue[0]+'</span></br>';
						}
					$j('#appTypeTable'+count).append(tablebody);	
					
					
				/* 		var appTypeValues = "";
						var masAppsession = msg.appointmentTypeList;
					 	 for(appType in masAppsession){
						 	appTypeValues += '<option value='+masAppsession[appType].masAppointmentType.appointmentTypeId+'>'
							+ masAppsession[appType].masAppointmentType.appointmentTypeName
							+ '</option>';	
							 }
					  
					  $j('#appointmentTypeId'+count).append(appTypeValues); */
					
				}else{
					$j('#appTypeTable'+count).empty();	
					//document.getElementById("appointmentTypeId"+count).options.length = 1;
				}
			},
			error : function(msg) {
				alert("An error has occurred while contacting the server");
			}
		});
		
	}

 /* function enableDropDown(rowValue){
	if($j('#opdCheckBox'+rowValue).prop("checked") == true){
		$j('#appTypeDivId'+rowValue).show();
	}
	else if($j('#opdCheckBox'+rowValue).prop("checked") == false){
		$j('#appTypeDivId'+rowValue).hide();
	}
 } */

 
 
 
 function validateDivToken(){
	 var arrParam=[];
	 var divCount = parseInt(document.getElementById('divCount').value);
	 for(var i=1; i<=divCount; i++){
		 var deptId = $j('#departmentId'+i).find('option:selected').val();
		 var appointmentTypeId=[];
		 $j.each($j('input[name=checkDiv'+i+']:checked'), function(){  
			  appointmentTypeId.push($j(this).val());
         });
		/*  var appointmentTypeId = $j('#appointmentTypeId'+i).find('option:selected').val(); */
		 var hospitalId = "1"; //Hospiatl id will fetch from session
		 var rowId=""+i;
			var params = {
				"rowId":rowId,
				"deptId":deptId,
				"appointmentTypeId":appointmentTypeId,
				"hospitalId" : hospitalId
			}
			arrParam.push(params);
	 } 
	
	 var resuestData ={
			"arrParam":arrParam
			}
	 
			$j.ajax({
				type : "POST",
				contentType : "application/json",
				url : 'tokenNoForDepartmentMultiVisit',
				data : JSON.stringify(resuestData),
				dataType : "json",
				cache : false,
				success : function(msg) {
					var displayToken = '';
					for(count in msg.jsonList){
						if( msg.jsonList[count].status=='1'){
							// rowID== i  condition should be exist.
							// $j('#tokenNoId'+msg.jsonList[count].rowId).show();
							// $j('#tokenNoId'+msg.jsonList[count].rowId).val(msg.jsonList[count].tokenMsg);
							displayToken += '<input type="text" name="tokenNo" id="tokenNoId'+msg.jsonList[count].rowId +'" value="'+msg.jsonList[count].tokenMsg+'" style="left-margin:10px">'; 
							
						}else{
							alert("else part");
						}
					}
					$j('#displayToken').html(displayToken);
					
				},
				error : function(msg) {
					alert("An error has occurred while contacting the server");
				}
			});
		
 }
 
 function addDiv(){
	 
	 var dictionary = ${data};
	 var deptList=dictionary.departmentList;
	 
	  var divList = document.getElementById('departmentNSessionList');	
	  var divCount = parseInt(document.getElementById("divCount").value);
	  var iteration = divCount+1;
	  
	  var newdiv = document.createElement('div');
	  newdiv.setAttribute('class', 'row');
      newdiv.setAttribute('id', 'div'+iteration);
      
      var subdiv = document.createElement('div');
      subdiv.setAttribute('class', 'col-md-3');
      
      var subsubdiv = document.createElement('div');
      subsubdiv.setAttribute('class', 'form-group row');
     
      var e1 = document.createElement('label');
	  e1.innerHTML = "Department<span>*<span>";
	  e1.setAttribute('class','col-sm-4 col-form-label');
	  subsubdiv.appendChild(e1);
	  subdiv.appendChild(subsubdiv);
	  newdiv.appendChild(subdiv); 
	   
	  var deptdiv = document.createElement('div');
	  deptdiv.setAttribute('class', 'col-md-8'); 
	   
      var e2 = document.createElement('Select');
	  e2.name='department';		  
	  e2.id='departmentId'+iteration;
	  e2.setAttribute('class','form-control');
	  e2.options[0] = new Option('Select', '0');
	  for(var i = 1;i<deptList.length;i++ ){
		e2.options[i] = new Option(deptList[i].departmentName,deptList[i].departmentId);
	 }
	  e2.onchange=function(){
		  // function need to write on change
		  geAppointmentType(iteration);
	      }
	  deptdiv.appendChild(e2);
	  subsubdiv.appendChild(deptdiv);
	  subdiv.appendChild(subsubdiv);
	  newdiv.appendChild(subdiv);  
	
      
	  var e3 = document.createElement('label');
	  e3.innerHTML = "Priority<span>*<span>";
	  /* e3.setAttribute("class", "col-sm-4 col-form-label");  */
	  newdiv.appendChild(e3);
	  
	  var e4 = document.createElement('Select');
	  e4.name='priority';		  
	  e4.id='priorityId'+iteration;
	  e4.innerHTML = document.getElementById('priorityId1').innerHTML;
	 /*  e4.setAttribute("class", "form-control"); */
	  newdiv.appendChild(e4);
    
	 
	  var tbldiv = document.createElement('div');
	/* deptdiv.setAttribute('class', 'form-group row');  */
	 var e5 = document.createElement("table");
	 e5.id='appTypeTable'+iteration;
	 e5.name='appTypeTable';
	 e5.setAttribute("width", "50%");
	 deptdiv.appendChild(e5);
	 newdiv.appendChild(deptdiv);
	 
	 
	 
	  var e6 = document.createElement('input');
	  e6.type = 'button';
	  e6.name='Button';
	  e6.value = 'Add';
	  e6.onclick=function(){addDiv();}
	  e6.setAttribute("class", "btn btn-primary");			 
	  newdiv.appendChild(e6);
	  
	  var e7 = document.createElement('input');
	  e7.type = 'button';
	  e7.name='button';
	  e7.value = 'Delete';
	  e7.onclick=function(){removeDiv();}
	  e7.setAttribute("class", "btn btn-danger");			 
	  newdiv.appendChild(e7);
	  
	  var subdiv = document.createElement('div');
	  subdiv.setAttribute('id', 'displayToken'+iteration);
	  var e8 = document.createElement('label');
	  e8.setAttribute("style", "margin-top: 100px;");
	  e8.setAttribute("style", "margin-bottom: 100px;");
	  subdiv.appendChild(e8);
	  
	  var e9 = document.createElement('input');
	  e9.type="text";
	  e9.name="tokenNoId"+iteration;
	  e9.id="tokenNoId"+iteration;
	  e9.setAttribute("style", "display:none");
	  subdiv.appendChild(e9);
	  newdiv.appendChild(subdiv);
	  
	  divList.appendChild(newdiv);
	  
	   var newline = document.createElement('div');
	   newline.setAttribute("class", "row");		
	   newdiv.appendChild(newline);
	   document.getElementById("divCount").value = iteration;


	}
 
 
function removeDiv()
{
var divCount = parseInt(document.getElementById("divCount").value);
if(divCount>1)
	{
	
	document.getElementById("div"+divCount).remove();
	document.getElementById("divCount").value = (divCount-1);
	}
} 



function submitFormdata(){
	//Below condition need to modify 
	var divCount = parseInt(document.getElementById("divCount").value);
	for(var i=1;i<=divCount;i++){
		var token =document.getElementById("tokenNoId"+i).value ;
		if(isNaN(token)){
			alert(token
					);
		}
	}
	
	 var params = {
				 "patientDetailsForm":$j('#patientDetailsForm').serializeObject() 
				}
	 
     $j.ajax({
   	  type : "POST",
		  contentType : "application/json",
		  url : 'submitPatientDetails',
		  data : JSON.stringify(params),
		  dataType : "json",
		  cache : false,
        success : function(response) {
       
        }
     });
}



$j.fn.serializeObject = function()
{
    var o = {};
    var a = this.serializeArray();
    $j.each(a, function() {
        if (o[this.name] !== undefined) {
            if (!o[this.name].push) {
                o[this.name] = [o[this.name]];
            }
            o[this.name].push(this.value || '');
        } else {
            o[this.name] = this.value || '';
        }
    });
    return o;
};
</script>
</body>
 </html> 