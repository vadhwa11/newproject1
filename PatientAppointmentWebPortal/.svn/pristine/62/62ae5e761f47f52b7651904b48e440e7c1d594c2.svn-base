<!doctype html>
<html lang="en">

<head>
 <%@ taglib prefix="form" uri="http://www.springframework.org/tags/form" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>  
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v3.8.5">
    <link href="${pageContext.request.contextPath}/resources/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="${pageContext.request.contextPath}/resources/css/icons.css" rel="stylesheet" type="text/css" />
    <link href="${pageContext.request.contextPath}/resources/css/metismenu.min.css" rel="stylesheet" type="text/css" />
    <link href="${pageContext.request.contextPath}/resources/css/app.css" rel="stylesheet" type="text/css" />    
    <link href="${pageContext.request.contextPath}/resources/css/style.css" rel="stylesheet" type="text/css" />
    
    <script src="${pageContext.request.contextPath}/resources/js/modernizr.min.js"></script>
    <script src="${pageContext.request.contextPath}/resources/js/jquery.min.js"></script>
    <%-- <script src="${pageContext.request.contextPath}/resources/js/bootstrap.bundle.min.js"></script>
    <script src="${pageContext.request.contextPath}/resources/js/metisMenu.min.js"></script>
    <script src="${pageContext.request.contextPath}/resources/js/waves.js"></script>
    <script src="${pageContext.request.contextPath}/resources/js/jquery.slimscroll.js"></script>
    <script src="${pageContext.request.contextPath}/resources/js/jquery.scrollTo.min.js"></script>    
	 <script src="${pageContext.request.contextPath}/resources/js/jquery.core.js"></script>
    <script src="${pageContext.request.contextPath}/resources/js/jquery.app.js"></script> --%>
 
<script type="text/javascript" src="${pageContext.request.contextPath}/resources/js/jquery.common.js"></script>
<script type="text/javascript" src="${pageContext.request.contextPath}/resources/js/common.js"></script>
<script type="text/javascript" language="javascript" src="${pageContext.request.contextPath}/resources/js/ajax.js"></script>
  
    
    <title>PERSONAL INFORMATION</title>

    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }
    </style>
    <!-- Custom styles for this template -->
</head>

<body>

    <table>
   <tr><td> Service Number: <input type="text" name="serviceNumber" id="serviceNumber"></td><td> <button id="getservice" type="button"  onclick="getServiceDetails();">Search</button></td></tr>
 </table>                                                 
	
     <!-- <label id="sNo"></label>
     <label id="empCode"></label> -->
  
     <form id="patientdetails" name="patientdetailsForm" method="post" modelAttribute="patientDetail" > 
   <div id="empDetails"> 
   

    Service No.: <input type="text" id="sNo" name="serviceNo" value="" readonly><br>
    Full Name: <input type="text" id="empName" name= "empName" value="" readonly>
    Unit/Location.: <input type="text" id="unit" value="" readonly><br>
    Age: <input type="text" id="age" value="" readonly>
    Department:<input type="text" id="department" value="" readonly><br>
    Gender: <input type="text" id="gender" value="" readonly>
    Rank: <input type="text" id="rank" value="" readonly><br>
    Mobile Number:<input type="text" id="mobile" value="" readonly><br><br>
    </div>
   <div> 
  <%--  <a class="btn btn-info" role="button" href="${pageContext.request.contextPath}/appointment/getAppointmentHistory">Appointment History</a>
   --%>
 </div>
  <div id="tblEmpAndDetails"  style="display:none" class="right_col" role="main" style="padding: 0.5%  1.8%;">
 <button class="btn btn-info" id="appointmentHistory" type="submit"  onclick="return  checkValidation()">Appointment History</button>
  
  <%-- <a class="btn btn-info" role="button" href="${pageContext.request.contextPath}/appointment/getAppointmentHistory?serviceNo=123457">Appointment History</a>
	 --%>                                                         <div class="clearfix"></div>
                                                            <h5 style="text-decoration:underline;">List of Details</h5>
                                                           <table class="table table-striped table-bordered  ">
                                                                            <thead>
                                                                                <tr>
                                                                                    <th id="th1">Select</th>
                                                                                    <th id="th2">Name</th>
                                                                                    <th id="th3">Relation</th>
                                                                                     <th id="th4">DOB</th>
                                                                                    <th id="th5">Age</th>
                                                                                    <th id="th6">Gender</th>
                                                                                   
                                                                                    
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody id="tblListOfEmployeeAndDepenent">
                                                                            </tbody>
                                                                        </table>
                                                   			
                                                   			 <%-- <a class="btn btn-info" role="button" href="${pageContext.request.contextPath}/appointment/bookAppointment" onclick="return chkValidation();">Book Now</a>
      --%>
	<%--  <button class="btn btn-info" id="appointmentHistory" type="submit" onclick="form.action='${pageContext.request.contextPath}/appointment/bookAppointment';" >Book Appointment</button> --%>
	   
	    <button class="btn btn-info" id="bookappointment" type="submit" onclick="return  checkbookappointmentValidation();" >Book Appointment</button>
	    </div>
   </form>

</body>

<script type="text/javascript">
jQuery(document).ready(function() {
	jQuery("#empDetails").hide();
	 
});
	
function getServiceDetails(){
	var serviceNumber;
	serviceNumber=document.getElementById('serviceNumber').value;
	if(document.getElementById('serviceNumber').value == null || document.getElementById('serviceNumber').value == ""){
		alert("Please Enter service Number .");
		return false;
	}
	
	
	var params = {
			 'serviceNo':serviceNumber
	 } 
	
	//alert("params: "+JSON.stringify(params)); 	
		jQuery.ajax({
		 crossOrigin: true,
		    method: "POST",
		    header:{
		    	'Access-Control-Allow-Origin': '*'
		    	},
		    	crossDomain:true,
		    url: "getServiceDetails",
		    data: JSON.stringify(params),
		    contentType: "application/json; charset=utf-8",
		    dataType: "json",
		    success: function(jsonData){
		    	console.log(jsonData);
		    	jQuery("#empDetails").show();
		    	  if(jsonData.status==1){
		    		
		    		  var htmlTable = "";
		    		    var data = jsonData.count;
		    		    var dataList = jsonData.data;
		    		    jQuery('#sNo').val(serviceNumber);
		    		    jQuery('#empName').val(dataList[1].empName);
		    		    jQuery('#unit').val(dataList[1].empUnitName);
		    		    jQuery('#age').val(dataList[1].empAge);//need to chk
		    		    jQuery('#department').val(dataList[1].empDepartmentName);
		    		    jQuery('#gender').val(dataList[1].gender);
		    		    jQuery('#mobile').val(dataList[1].mobileNumber);
		    		    jQuery('#rank').val(dataList[1].empRank);
		    				 for(item in dataList){
		    					  // htmlTable += '<tr id="'+dataList[item].Id+'" onclick="hello('+dataList+')">';
		    					  htmlTable = htmlTable + "<tr id='" + dataList[item].Id + "'>";
		    					  htmlTable = htmlTable + "<td style='width: 150px;' name='ename'><input type='radio' onclick='getValue(\""+item+"\",\""+jsonData+"\");' id='patient' name='patient' value='"+dataList[item].name+","+dataList[item].relation+","+dataList[item].dateOfBirth+","+dataList[item].age+","+dataList[item].genderId+","+dataList[item].uhidNo+","+dataList[item].employeeId+","+dataList[item].serviceNo+","+dataList[item].relationId+"'></td>";
		    			    	  htmlTable = htmlTable + "<td style='width: 150px;'>" + dataList[item].name + "</td>";
		    			    	  htmlTable = htmlTable + "<td style='width: 150px;'>" + dataList[item].relation + "</td>";
		    			    	  htmlTable = htmlTable + "<td style='width: 150px;'>" + dataList[item].dateOfBirth + "</td>";
		    			    	  htmlTable = htmlTable + "<td style='width: 150px;'>" + dataList[item].age + "</td>";
		    			    	  htmlTable = htmlTable + "<td style='width: 150px;'>" + dataList[item].gender + "</td>";
		    			    	 
		    			    	
		    			      }
		    			      $j("#tblListOfEmployeeAndDepenent").html(htmlTable);
		    				  $j('#tblEmpAndDetails').show();
		    			}else{
		    				 $j('#message').html(jsonData.msg);
		    				 $j('#tblEmpAndDetails').empty();
		    				 $j("#tblListOfEmployeeAndDepenent").empty();
		    				 /* $j(document).ready(function(){
		    		             $j('#message').fadeOut(5000);
		    		             }); */
		    		        
		    			}
		       
		        
		    }
		    
		    
		});
	
}
function checkValidation() {
	
	/* var str = $j("input:radio[name=patient]:checked").val();
	var myarray = str.split(',');
     if(myarray[5]==0)
	{
	alert("No Appointment history");
	return false;
	}  */
	document.patientdetailsForm.action="${pageContext.request.contextPath}/appointment/getAppointmentHistory";
	
	}

function checkbookappointmentValidation() {
	
	 var str = $j("input:radio[name=patient]:checked").val();
	
  if (typeof str === 'undefined' || str instanceof String)
	{
	alert("Please select radio button");
	return false;
	} 
	document.patientdetailsForm.action="${pageContext.request.contextPath}/appointment/bookAppointment";
}


function getValue(rowId,jsonData) {
	alert("jsonData"+jsonData+"rId"+rowId);
	var dataList=jsonData.data;
	
	/* var dataMain = JSON.parse(JSON.stringify(jsonData));
	alert("dataMain"+dataMain.count);
	 */
	 alert("Please select radio button-----"+dataList);
	/*  for(item in dataList){
		 if(dataList[item].Id===parseInt(rowId)){
			
	 $j('#medicalCategoryId').val("0"); 
		$j('#dateId').val(""); 
		$j('#durationId').val("0"); 
		$j('#departmentId').val("0"); 
		$j('#appTypeTable').empty();
		$j('#displayToken').empty(); 

		 } */
	
	
}
</script>
</html>